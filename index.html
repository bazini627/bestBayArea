<!DOCTYPE html>
<html>
<head>
  <meta charset=utf-8 />
  <title>Economic Security In The Bay Area</title>
  <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />

  <!-- latest version of CARTO.js -->
  <script src="https://cartodb-libs.global.ssl.fastly.net/cartodb.js/v3/3.15/cartodb.js"></script>

  <!-- style sheet for CARTO.js -->
  <link rel="stylesheet" href="https://cartodb-libs.global.ssl.fastly.net/cartodb.js/v3/3.15/themes/css/cartodb.css" />
  <!-- style sheet for google fonts -->
  <link href='//fonts.googleapis.com/css?family=Vollkorn' rel='stylesheet' type='text/css'>

  <style>
    body {
      margin:0;
      padding:0;
      background: whitesmoke;
      font-family: "Vollkorn";
    }
    #map {
      position:absolute;
      top:0;
      bottom:0;
      right: 0;
      width: 67%;
    }
    #side-panel {
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 33%;
      background: whitesmoke;
      overflow-y: scroll;
    }
    h1 {
      padding: 8px 25px 8px 15px;
      margin: 0;
      background: #b3de69;
      color: whitesmoke;
      font-weight: 400;
      font-size: 1.2em;
      text-align: center;
    }
    h2 {
      margin: 0;
      padding: 8px 25px 8px 15px;
      color: #b3de69;
      font-weight: 500;
      font-size: 1.2em;
      text-align: center;
    }
    #side-panel p {
      margin: 8px 0 4px;
      padding: 0 25px 0 15px;
      color: #3d3d3d;
      font-size: 1em;
    }
    #side-panel p:after {
      content: '';
      display: block;
      clear: both;
    }
    .legend {
      padding: 6px 8px;
      font-size: 1em;
      background: rgba(255, 255, 255,0.8);
      box-shadow: 0 0 15px rgba(0,0,0,2);
      border-radius: 5px;
    }
    .legend h3 {
      font-size: 1.1em;
      font-weight: normal;
      color: #001323;
      margin: 0 0 10px 0;
    }
    .legend span {
      width: 20px;
      height: 20px;
      float: left;
      border: 1px solid;
      margin: 0 10px 4px 0;
    }
    .legend label {
      font-size: 1.1em;
    }
    .legend label:after {
      content: '';
      display: block;
      clear: both;
    }
    #ui-controls {
      position: relative;
      margin-left: 34%;
      padding-bottom: 5px;
      z-index: 650;
    }
    #ui-controls label {
      font-size: 1em;
      margin-right: 5px;
    }
  </style>
</head>
<body>
  <div id='ui-controls'>
    <label>BEST Data For The Bay Area <br> Choose A Family Type:</label>
    <select id="FamilyType">
      <option value="1 worker(s)" selected>Single Worker</option>
      <option value="1 worker(s), 1 infant(s)">Single Worker, One Infant</option>
      <option value="2 worker(s)">Two Workers</option>
      <option value="2 worker(s), 1 infant(s)">Two Workers, One Infant</option>
    </select>
  </div>
  <div id='map'></div>
  <div id='side-panel'>
    <h1>What Does It Take To Live In The Bay Area?</h1>
    <h2>Economic Security In Bay Area Counties</h2>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam mollis laoreet elementum. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Donec mi eros, rutrum sed orci eget, venenatis varius est. Pellentesque accumsan est vitae risus malesuada fringilla.</p>
    <p>Cras at massa in leo aliquam fermentum. Nunc auctor vestibulum sagittis. Aliquam pulvinar, ipsum in pulvinar tincidunt, enim metus fermentum tellus, quis accumsan ex lorem ut ante. Phasellus fermentum orci eget interdum ultrices. Proin vitae magna id odio ultricies placerat quis id ex. Aenean volutpat volutpat gravida.</p>
    <h2>About This Map</h2>
    <p>Phasellus in ante nec augue pulvinar pellentesque id vitae nunc. Donec tincidunt metus metus, sed rhoncus ex vehicula sed. Donec erat felis, dignissim bibendum metus ut, tincidunt dictum ligula. Aliquam interdum gravida enim id aliquet. Duis sed ex sed mi aliquam hendrerit. Nunc egestas in lorem ac consectetur. Donec quis rhoncus metus.</p>
    <h2>About The Data</h2>
    <p>Phasellus in ante nec augue pulvinar pellentesque id vitae nunc. Donec tincidunt metus metus, sed rhoncus ex vehicula sed. Donec erat felis, dignissim bibendum metus ut, tincidunt dictum ligula. Aliquam interdum gravida enim id aliquet. Duis sed ex sed mi aliquam hendrerit. Nunc egestas in lorem ac consectetur. Donec quis rhoncus metus.</p>
  </div>
  <!-- CARTO CSS For County Layer -->
  <script type="cartocss/html" id="county-styles">
    #layer {
      polygon-fill: ramp([county], ('#8dd3c7', '#ffffb3', '#bebada', '#fb8072', '#80b1d3', '#fdb462', '#bc80bd', '#fccde5', '#d9d9d9'), category(9));
      line-width: 1;
      line-color: black;
      line-opacity: 0.5;
    }
  </script>

  <script>

    // Object to hold our map options
    var options = {
      center: [37.8741, -122.25],
      zoom: 8,
      minZoom: 8,
      maxZoom: 8,
      zoomControl: false,
    },
    datalayer, // Global variable for map units
    currentFamilyType = "FamilyType",
    map = L.map('map', options); // Create map object and pass it our options object from above

    // Load a map tile and add it to the map
    var tiles = L.tileLayer('https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="https://carto.com/attributions">CARTO</a>',
      subdomains: 'abcd',
      maxZoom: 19
    }).addTo(map);

    // Our CARTO data
    var sourceObject = {
      user_name: 'mjbmaps',
      type: 'cartodb',
      sublayers: [
        {
          sql: "SELECT * FROM bayareacounties_best_data",
          cartocss: $("#county-styles").text()
        }
      ]
    }

    // Add map to page
    cartodb.createLayer(map, sourceObject).addTo(map)
    .on('done', function(layer) {
      console.log("Map loaded")
    })
    .on('error', function(err) {
      console.log(err);
    });

    // Create a legend for our counties
    var legend = new cdb.geo.ui.Legend.Custom({
      type: "custom",
      title: "Bay Area Counties",
      data: [
        { name: "Alameda",       value: "#8dd3c7" },
        { name: "Contra Costa",  value: "#ffffb3" },
        { name: "Marin",         value: "#bebada" },
        { name: "Napa",          value: "#fb8072" },
        { name: "San Francisco", value: "#80b1d3" },
        { name: "San Mateo",     value: "#fdb462" },
        { name: "Santa Clara",   value: "#bc80bd" },
        { name: "Solano",        value: "#fccde5" },
        { name: "Sonoma",        value: "#d9d9d9" }
      ]
    });
    $('#map').append(legend.render().el);

    window.onload = main;

    </script>
</body>
</html>
